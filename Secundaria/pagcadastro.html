<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<link rel="stylesheet" href="visualcadastro.css">
<title>Cadastre-se</title>

</head>
<body class="fundocadas">

<main class="card" role="main" aria-labelledby="title">
<h1 id="title">CADASTRE-SE</h1>
<p class="lead">Preencha os dados abaixo para criar sua conta.</p>

<form id="cadastroForm" novalidate>
    <div class="field">
    <label for="nome">Nome / Razão Social</label>
    <input id="nome" name="nome" type="text" placeholder="Ex: João Silva ou Empresa ABC Ltda" required minlength="2" />
    <div class="small" aria-hidden="true">Informe seu nome completo ou razão social.</div>
    </div>

    <div class="field">
    <label for="cpfcnpj">CPF / CNPJ</label>
    <input id="cpfcnpj" name="cpfcnpj" type="text" inputmode="numeric" placeholder="Somente números (ex: 00000000000 ou 00000000000000)" required />
    <div class="small">Informe somente números — 11 dígitos para CPF ou 14 para CNPJ.</div>
    </div>

    <div class="row">
    <div class="col field">
        <label for="email">Email / Telefone</label>
        <input id="email" name="email" type="email" placeholder="exemplo@dominio.com" />
        <div class="small">Pode inserir e‑mail ou deixar em branco se usar telefone abaixo.</div>
    </div>

    <div class="col field">
        <label for="telefone">Telefone</label>
        <input id="telefone" name="telefone" type="tel" inputmode="tel" placeholder="(00) 90000-0000" />
        <div class="small">Formato recomendado: apenas números ou com máscara local.</div>
    </div>
    </div>

    <div class="field">
    <label for="senha">Senha</label>
    <input id="senha" name="senha" type="password" minlength="6" placeholder="Mínimo 6 caracteres" required />
    <div class="small">Use pelo menos 6 caracteres; inclua números e símbolos para maior segurança.</div>
    </div>

    <div id="errors" class="error" role="alert" aria-live="polite" style="display:none"></div>

    <div style="margin-top:6px">
    <button id="submitBtn" class="btn" type="submit">CRIAR</button>
    </div>
</form>
</main>

<script>
(function(){
    const form = document.getElementById('cadastroForm');
    const cpfCnpj = document.getElementById('cpfcnpj');
    const email = document.getElementById('email');
    const telefone = document.getElementById('telefone');
    const senha = document.getElementById('senha');
    const nome = document.getElementById('nome');
    const errorsEl = document.getElementById('errors');

    // Remove tudo que não for dígito para validação simples
    function onlyDigits(val){ return (val||'').replace(/\\D/g,''); }

    function showError(msg){
    errorsEl.style.display = 'block';
    errorsEl.textContent = msg;
    }
    function clearError(){
    errorsEl.style.display = 'none';
    errorsEl.textContent = '';
    }

    form.addEventListener('submit', function(ev){
    ev.preventDefault();
    clearError();

    // campos obrigatórios
    if (!nome.value.trim()){
        showError('O campo Nome / Razão Social é obrigatório.');
        nome.focus();
        return;
    }
    if (!senha.value || senha.value.length < 6){
        showError('Senha inválida: digite pelo menos 6 caracteres.');
        senha.focus();
        return;
    }

    const cpfcnpjDigits = onlyDigits(cpfCnpj.value);
    if (!(cpfcnpjDigits.length === 11 || cpfcnpjDigits.length === 14)){
        showError('CPF/CNPJ inválido: informe 11 dígitos (CPF) ou 14 dígitos (CNPJ).');
        cpfCnpj.focus();
        return;
    }

    // validar pelo menos email OU telefone preenchido
    const hasEmail = email.value.trim() !== '';
    const hasTel = onlyDigits(telefone.value).length >= 8; // validação simples
    if (!hasEmail && !hasTel){
        showError('Informe ao menos Email ou Telefone.');
        email.focus();
        return;
    }

    // validação simples do e-mail se informado
    if (hasEmail){
        const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
        if (!re.test(email.value.trim())){
        showError('Formato de e‑mail inválido.');
        email.focus();
        return;
        }
    }

    // se passou nas validações, montar objeto de dados (exemplo)
    const dados = {
        nome: nome.value.trim(),
        cpfcnpj: cpfcnpjDigits,
        email: hasEmail ? email.value.trim() : null,
        telefone: hasTel ? onlyDigits(telefone.value) : null,
        senha: senha.value
    };

    // Aqui você integraria com seu backend (fetch). Por segurança o exemplo apenas exibe.
    console.log('Dados do cadastro (prontos para envio):', dados);

    // Feedback ao usuário (poderia redirecionar)
    alert('Cadastro validado com sucesso! (ver console para os dados)');
    form.reset();
    });

    // Máscara visual simples para CPF/CNPJ (opcional) - apenas estética
    cpfCnpj.addEventListener('input', function(){
    const d = onlyDigits(this.value);
    if (d.length <= 11){
        // formata CPF: 000.000.000-00
        const p1 = d.slice(0,3);
        const p2 = d.slice(3,6);
        const p3 = d.slice(6,9);
        const p4 = d.slice(9,11);
        this.value = [p1, p2, p3].filter(Boolean).join('.') + (p4 ? '-' + p4 : '');
    } else {
        // formata CNPJ: 00.000.000/0000-00
        const a = d.slice(0,2);
        const b = d.slice(2,5);
        const c = d.slice(5,8);
        const d4 = d.slice(8,12);
        const e = d.slice(12,14);
        this.value = [a, b, c].filter(Boolean).join('.') + (d4 ? '/' + d4 : '') + (e ? '-' + e : '');
    }
    });

    // opcional: máscara simples de telefone
    telefone.addEventListener('input', function(){
    const d = onlyDigits(this.value);
    if (!d) { this.value = ''; return; }
    if (d.length <= 2) this.value = '(' + d;
    else if (d.length <= 6) this.value = '(' + d.slice(0,2) + ') ' + d.slice(2);
    else if (d.length <= 10) this.value = '(' + d.slice(0,2) + ') ' + d.slice(2,6) + '-' + d.slice(6);
    else this.value = '(' + d.slice(0,2) + ') ' + d.slice(2,7) + '-' + d.slice(7,11);
    });

})();
</script>
</body>
</html>
